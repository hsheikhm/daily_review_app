/*! daily-review-app 03-05-2016 */
var dailyReviewApp=angular.module("dailyReviewApp",["firebase","ngRoute"]);dailyReviewApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"dist/partials/login.html",controller:"LoginCtrl"}).when("/register",{templateUrl:"dist/partials/register.html",controller:"RegisterCtrl"}).when("/login-success-path-student",{templateUrl:"dist/partials/student-form.html",controller:"FormCtrl"}).when("/login-success-path-coach",{templateUrl:"dist/partials/coach-findings.html",controller:"FindingsCtrl"}).otherwise({redirectTo:"/"})}]),dailyReviewApp.controller("FindingsCtrl",["$scope","$firebaseObject","RatingFactory",function(a,b,c){var d=new Firebase("https://shining-fire-9962.firebaseio.com"),e=b(d);e.$bindTo(a,"users");var f=new c,g=new c;a.show=function(b){a.select=b},a.getAverage=function(b){return a.a=0,b.forEach(function(b){a.a+=b}),a.a/b.length},a.updateAverages=function(){a.seniorChallengeAverage=a.getAverage(g.challengeRating),a.juniorChallengeAverage=a.getAverage(f.challengeRating),a.seniorFeelingAverage=a.getAverage(g.feelingRating),a.juniorFeelingAverage=a.getAverage(f.feelingRating),a.seniorPairingAverage=a.getAverage(g.pairingRating),a.juniorPairingAverage=a.getAverage(f.pairingRating)},a.updateConfidenceAverages=function(){f.moreConfident()?a.juniorConfidenceAverage="Yes":a.juniorConfidenceAverage="No",g.moreConfident()?a.seniorConfidenceAverage="Yes":a.seniorConfidenceAverage="No"},d.on("child_added",function(b){"Nov 2015"===b.val().cohort?f.collectRatings(b):"Oct 2015"===b.val().cohort&&g.collectRatings(b),a.updateAverages(),a.updateConfidenceAverages()})}]),dailyReviewApp.controller("FormCtrl",["$scope","$rootScope","$filter",function(a,b,c){var d=new Firebase("https://shining-fire-9962.firebaseio.com");a.addReview=function(){d.push({name:b.userName,cohort:a.cohort,pairing:a.pairing,pairingExtra:a.pairingExtra||"",challenge:a.challenge,challengeExtra:a.challengeExtra||"",feeling:a.feeling,feelingExtra:a.feelingExtra||"",confidence:a.confidence,comments:a.comments||"",date:c("date")(new Date,"dd-MM-yy")})},a.thankYou=function(){a.done=!0}}]),dailyReviewApp.controller("LoginCtrl",["$scope","$location","$rootScope",function(a,b,c){var d=new Firebase("https://shining-fire-9962.firebaseio.com");a.loginUser=function(){d.authWithPassword({email:a.email,password:a.password},function(b,c){b?console.log("Login Failed!",b):a.allowLogin(c)})},a.allowLogin=function(c){a.makersAdmin()?(console.log("Authenticated successfully with:",c),a.$apply(function(){b.path("/login-success-path-coach")})):(console.log("Authenticated successfully with:",c),a.$apply(function(){b.path("/login-success-path-student")}))},a.makersAdmin=function(){return"admin@makers.com"===a.email},a.loginGitHub=function(){d.authWithOAuthPopup("github",function(d,e){d?console.log("Login Failed!",d):(console.log("Authenticated successfully with:",e.github.displayName),a.$apply(function(){b.path("/login-success-path-student")}),c.userName=e.github.displayName)})}}]),dailyReviewApp.controller("RegisterCtrl",["$scope","$location",function(a,b){var c=new Firebase("https://shining-fire-9962.firebaseio.com");a.addUser=function(){c.createUser({email:a.email,password:a.password},function(c,d){c?console.log("Error creating user:",c):a.makersAdmin()?(console.log("Successfully created user account with uid:",d.uid),a.$apply(function(){b.path("/login-success-path-coach")})):(console.log("Successfully created user account with uid:",d.uid),a.$apply(function(){b.path("/login-success-path-student")}))})},a.makersAdmin=function(){return"admin@makers.com"===a.email}}]),dailyReviewApp.controller("ToggleCtrl",["$scope",function(a){a.state=!1,a.toggleState=function(){a.state=!a.state},a.hoverOn=function(){this.showStats=!0},a.hoverNot=function(){this.showStats=!1}}]),dailyReviewApp.directive("juniorsRatings",function(){return{restrict:"E",templateUrl:"/views/juniors-ratings.html"}}),dailyReviewApp.directive("seniorsRatings",function(){return{restrict:"E",templateUrl:"/views/seniors-ratings.html"}}),dailyReviewApp.directive("cohortQuestion",function(){return{restrict:"E",templateUrl:"/views/cohort-question.html"}}),dailyReviewApp.directive("pairingQuestion",function(){return{restrict:"E",templateUrl:"/views/pairing-question.html"}}),dailyReviewApp.directive("challengeQuestion",function(){return{restrict:"E",templateUrl:"/views/challenge-question.html"}}),dailyReviewApp.directive("confidenceQuestion",function(){return{restrict:"E",templateUrl:"/views/confidence-question.html"}}),dailyReviewApp.directive("feelingQuestion",function(){return{restrict:"E",templateUrl:"/views/feeling-question.html"}}),dailyReviewApp.directive("commentsQuestion",function(){return{restrict:"E",templateUrl:"/views/comments-question.html"}}),dailyReviewApp.directive("sidebarDirective",function(){return{link:function(a,b,c){a.$watch(c.sidebarDirective,function(a){return a?void b.addClass("show"):void b.removeClass("show")})}}}),dailyReviewApp.factory("RatingFactory",function(){function a(){this.challengeRating=[],this.feelingRating=[],this.pairingRating=[],this.confidenceYes=[],this.confidenceNo=[],this.collectRatings=function(a){this.challengeRating.push(a.val().challenge),this.feelingRating.push(a.val().feeling),this.pairingRating.push(a.val().pairing),this.collectConfidenceRatings(a)},this.collectConfidenceRatings=function(a){"Yes"===a.val().confidence?this.confidenceYes.push(a.val().confidence):"No"===a.val().confidence&&this.confidenceNo.push(a.val().confidence)},this.moreConfident=function(){return this.confidenceYes.length>=this.confidenceNo.length}}return a});